<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <title>Nur & Ilm — Digital Tadabbur</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: #050505;
      overflow: hidden;
      font-family: system-ui, sans-serif;
      color: #f2f2f2;
    }

    canvas { display: block; }

    #start-overlay {
      position: fixed;
      inset: 0;
      background: #050505;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }

    #start-overlay button {
      background: none;
      border: 1px solid #d4af37;
      color: #d4af37;
      padding: 16px 36px;
      font-size: 16px;
      letter-spacing: 0.1em;
      cursor: pointer;
    }

    #text-overlay {
      position: fixed;
      top: 26px;
      width: 100%;
      text-align: center;
      pointer-events: none;
      z-index: 5;
    }

    #ayah {
      font-size: 26px;
      line-height: 1.9;
      opacity: 0;
      transition: opacity 3s ease;
    }

    #translation {
      margin-top: 6px;
      font-size: 13px;
      opacity: 0.6;
    }

    #hikmah {
      margin-top: 14px;
      font-size: 14px;
      opacity: 0;
      transition: opacity 2s ease;
    }
  </style>

  <!-- THREE -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

  <!-- MEDIAPIPE -->
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
</head>

<body>

<div id="start-overlay">
  <button id="start-btn">BOSHLASH</button>
</div>

<div id="text-overlay">
  <div id="ayah"></div>
  <div id="translation"></div>
  <div id="hikmah"></div>
</div>

<script>
/* ============================================================
   OYATLAR + HIKMATLAR
   ============================================================ */
const SEQUENCE = [
  {
    ar: "﴿اللَّهُ نُورُ السَّمَاوَاتِ وَالْأَرْضِ﴾",
    uz: "Alloh osmonlar va yerning nuridir",
    hikmah: "— Ilm hikmati: Nur — anglash imkonidir."
  },
  {
    ar: "﴿اقْرَأْ بِاسْمِ رَبِّكَ الَّذِي خَلَقَ﴾",
    uz: "Yaratgan Robbing nomi bilan o‘qi",
    hikmah: "— Ilm hikmati: Ilm ibodat bilan boshlanadi."
  },
  {
    ar: "﴿هَلْ يَسْتَوِي الَّذِينَ يَعْلَمُونَ وَالَّذِينَ لَا يَعْلَمُونَ﴾",
    uz: "Biladiganlar bilan bilmaydiganlar teng bo‘lurmi?",
    hikmah: "— Ilm hikmati: Bilish mas’uliyatdir."
  },
  {
    ar: "﴿أَوَلَمْ يَرَ الَّذِينَ كَفَرُوا أَنَّ السَّمَاوَاتِ وَالْأَرْضَ كَانَتَا رَتْقًا﴾",
    uz: "Osmonlar va yer bir butun bo‘lganini ko‘rmaydilarmi?",
    hikmah: "— Ilm hikmati: Koinot kengaymoqda."
  },
  {
    ar: "﴿أَفَلَا يَنْظُرُونَ إِلَى الْإِبِلِ كَيْفَ خُلِقَتْ﴾",
    uz: "Ular yaratilishga nazar solmaydilarmi?",
    hikmah: "— Ilm hikmati: Tafakkur kuzatishdan boshlanadi."
  },
  {
    ar: "﴿سَنُرِيهِمْ آيَاتِنَا فِي الْآفَاقِ وَفِي أَنْفُسِهِمْ﴾",
    uz: "Biz oyatlarimizni ufqlarda va o‘zlarida ko‘rsatamiz",
    hikmah: "— Ilm hikmati: Qalb va koinot uyg‘un."
  }
];

/* ============================================================
   THREE.JS — FON
   ============================================================ */
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 100);
camera.position.z = 3;

const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(innerWidth, innerHeight);
renderer.setClearColor(0x050505);
document.body.appendChild(renderer.domElement);

const COUNT = 12000;
const geo = new THREE.BufferGeometry();
const pos = new Float32Array(COUNT * 3);

for (let i=0;i<COUNT;i++){
  const r = Math.cbrt(Math.random());
  const t = Math.random()*Math.PI*2;
  const p = Math.acos(2*Math.random()-1);
  pos[i*3]=r*Math.sin(p)*Math.cos(t);
  pos[i*3+1]=r*Math.sin(p)*Math.sin(t);
  pos[i*3+2]=r*Math.cos(p);
}

geo.setAttribute("position", new THREE.BufferAttribute(pos,3));

const mat = new THREE.PointsMaterial({
  color:0xfff6cc,
  size:0.01,
  blending:THREE.AdditiveBlending,
  depthWrite:false
});

const pts = new THREE.Points(geo,mat);
scene.add(pts);

/* ============================================================
   AUDIO ENGINE — NAFAS + HUM
   ============================================================ */
let audioCtx, humOsc, humGain, noiseSrc, noiseGain, noiseFilter;
let calmness = 0.5;

function initAudio(){
  audioCtx = new AudioContext();

  // Past hum
  humOsc = audioCtx.createOscillator();
  humOsc.type = "sine";
  humOsc.frequency.value = 55;

  humGain = audioCtx.createGain();
  humGain.gain.value = 0.015;

  humOsc.connect(humGain).connect(audioCtx.destination);
  humOsc.start();

  // Nafas shovqini
  const bufferSize = audioCtx.sampleRate * 2;
  const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
  const data = buffer.getChannelData(0);
  for (let i = 0; i < bufferSize; i++) {
    data[i] = (Math.random() * 2 - 1) * 0.2;
  }

  noiseSrc = audioCtx.createBufferSource();
  noiseSrc.buffer = buffer;
  noiseSrc.loop = true;

  noiseFilter = audioCtx.createBiquadFilter();
  noiseFilter.type = "bandpass";
  noiseFilter.frequency.value = 600;

  noiseGain = audioCtx.createGain();
  noiseGain.gain.value = 0.0;

  noiseSrc.connect(noiseFilter).connect(noiseGain).connect(audioCtx.destination);
  noiseSrc.start();
}

function updateAudio(motion){
  calmness = THREE.MathUtils.lerp(calmness, motion, 0.05);
  humGain.gain.value = 0.01 + calmness * 0.02;
  noiseGain.gain.value = (1 - calmness) * 0.015;
}

/* ============================================================
   OYAT ROTATSIYASI
   ============================================================ */
let index = 0;
const ayahEl = document.getElementById("ayah");
const trEl = document.getElementById("translation");
const hikmahEl = document.getElementById("hikmah");

function showCurrent() {
  const item = SEQUENCE[index];
  ayahEl.textContent = item.ar;
  trEl.textContent = item.uz;
  hikmahEl.textContent = item.hikmah;

  ayahEl.style.opacity = 1;
  hikmahEl.style.opacity = 1;
}

function nextAyah(){
  index = (index + 1) % SEQUENCE.length;
  showCurrent();
}

/* ============================================================
   ANIMATSIYA
   ============================================================ */
function animate(){
  pts.rotation.y += 0.0002;
  updateAudio(Math.abs(pts.rotation.y % 1));
  renderer.render(scene,camera);
  requestAnimationFrame(animate);
}

/* ============================================================
   START
   ============================================================ */
document.getElementById("start-btn").onclick = () => {
  document.getElementById("start-overlay").remove();
  initAudio();
  showCurrent();
  animate();
  setInterval(nextAyah, 18000);
};
</script>

</body>
</html>
</file>

</project>