<!DOCTYPE html>
<html lang="uz" class="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ilm Nuri Premium | Made by ©️Muhammad Daler</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script>
tailwind.config = {
darkMode: 'class',
theme: {extend: {fontFamily: {sans: ['Inter']},colors: {brand: {bg: '#0f0f23',card: '#1a1a2e',primary: '#0ea5e9',secondary: '#3b82f6',accent: '#10b981',gold: '#f59e0b',error: '#ef4444'}}}}
}
</script>
<style>
body {background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%);color: #f1f5f9;font-family: 'Inter', sans-serif;overflow-x: hidden;}
.glass {background: rgba(26,26,46,0.8);backdrop-filter: blur(20px);border: 1px solid rgba(255,255,255,0.1);}
.no-scrollbar::-webkit-scrollbar {display: none;}
.perspective-1200 {perspective: 1200px;}
.card-inner {transition: transform 0.7s ease-out;transform-style: preserve-3d;}
.flipped {transform: rotateY(180deg);}
.card-face {backface-visibility: hidden;border-radius: 20px;padding: 2rem;box-shadow: 0 20px 40px rgba(0,0,0,0.3);}
.card-front {background: linear-gradient(145deg, #1a1a2e, #16213e);}
.card-back {transform: rotateY(180deg);background: linear-gradient(145deg, #16213e, #0f0f23);}
.btn-small {h-14 w-14 p-3 rounded-xl active:scale-95;}
.haptic:active {transform: scale(0.96);}
.cloze-hidden {background: linear-gradient(#3b82f6,#6366f1);color: transparent;border-radius: 8px;padding: 4px 8px;font-weight: bold;}
.cloze-revealed {color: #60a5fa;font-weight: bold;border-radius: 8px;padding: 4px 8px;background: rgba(59,130,246,0.2);}
.sidebar {transform: translateX(-100%);transition: 0.4s;}
.sidebar.open {transform: translateX(0);}
</style>
</head>
<body class="flex flex-col h-screen max-w-md mx-auto">
<header class="glass h-16 flex items-center justify-between px-4 z-40 border-b border-slate-700">
<div class="flex items-center gap-3">
<i class="fa-solid fa-brain w-10 h-10 bg-gradient-to-r from-primary to-secondary text-white rounded-xl flex-center text-xl animate-pulse-glow p-2"></i>
<div>
<h1 class="font-bold text-lg">Ilm Nuri</h1>
<p class="text-xs text-slate-400">Premium Smart Anki</p>
</div>
</div>
<div class="flex items-center gap-2">
<div class="text-right">
<span class="text-xs text-slate-400 uppercase font-bold">Streak</span>
<span id="streak" class="text-gold font-bold flex items-center gap-1">
<i class="fa-solid fa-fire"></i><span>0</span>
</span>
</div>
<button onclick="Router.nav('settings')" class="haptic p-2 rounded-lg hover:bg-white/10">
<i class="fa-solid fa-gear text-slate-400"></i>
</button>
</div>
</header>

<main id="viewport" class="flex-1 overflow-auto p-6 pb-28 no-scrollbar">
<!-- Content -->
</main>

<nav class="fixed bottom-0 w-full max-w-md mx-auto h-20 flex items-end justify-around px-4 pt-2 z-30 glass rounded-t-2xl shadow-2xl backdrop-blur-xl">
<button onclick="Router.nav('decks')" id="nav-decks" class="btn-small text-slate-400 hover:text-primary flex flex-col items-center gap-1 haptic">
<i class="fa-solid fa-layer-group text-lg"></i>
<span class="text-xs font-bold">Darslar</span>
</button>
<button onclick="Router.nav('study')" id="nav-study" class="btn-small text-slate-400 hover:text-accent flex flex-col items-center gap-1 haptic">
<i class="fa-solid fa-play text-lg"></i>
<span class="text-xs font-bold">O'qish</span>
</button>
<button onclick="Router.nav('add')" id="nav-add" class="h-16 w-16 bg-gradient-to-br from-primary to-secondary text-white rounded-2xl shadow-2xl shadow-primary/30 hover:shadow-primary/50 active:scale-90 haptic mx-1 z-10">
<i class="fa-solid fa-plus text-2xl font-bold"></i>
</button>
<button onclick="Router.nav('profile')" id="nav-profile" class="btn-small text-slate-400 hover:text-gold flex flex-col items-center gap-1 haptic">
<i class="fa-solid fa-chart-pie text-lg"></i>
<span class="text-xs font-bold">Stats</span>
</button>
</nav>

<!-- Sidebar -->
<div id="sidebar" class="sidebar fixed left-0 top-0 h-full w-64 glass z-50 p-8 pt-20">
<h2 class="font-bold text-xl mb-6 flex items-center gap-3">
<i class="fa-solid fa-bars text-primary"></i>
Darslar
</h2>
<div id="deck-list" class="space-y-3 overflow-auto h-96 no-scrollbar">
<!-- Decks list -->
</div>
<button onclick="Sidebar.close()" class="absolute top-6 right-4 text-slate-400 hover:text-white">
<i class="fa-solid fa-xmark"></i>
</button>
</div>

<!-- Overlay -->
<div id="overlay" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-40 hidden" onclick="Sidebar.close()"></div>

<!-- Motivation Modal -->
<div id="motivation" class="fixed inset-0 glass z-50 hidden flex items-center justify-center p-8">
<div class="max-w-sm w-full mx-4 text-center glass-card p-12 rounded-3xl shadow-2xl animate-float">
<i class="fa-solid fa-star text-6xl text-gold mb-4"></i>
<h2 class="text-2xl font-black mb-2">Sessiya Tugadi!</h2>
<p class="text-lg text-slate-300 mb-6">Hikmat: <strong id="hikmat"></strong></p>
<button onclick="Motivation.close()" class="w-full py-4 bg-primary text-white font-bold rounded-2xl shadow-lg hover:shadow-primary/50 haptic">
Davom Et
</button>
</div>
</div>

<!-- Toast -->
<div id="toast" class="fixed bottom-28 left-1/2 -translate-x-1/2 bg-card text-white px-6 py-3 rounded-2xl shadow-2xl z-40 hidden flex items-center gap-3">
<i class="fa-solid fa-check text-accent"></i>
<span id="toast-text"></span>
</div>

<script>
LANG = localStorage.getItem('lang') || 'uz';
const T = {
uz: {decks: 'Darslar', study: 'O\'qish', add: 'Qoshish', profile: 'Stats', settings: 'Sozlamalar', ...}, // full map from previous
en: {...}
};
function _(k) { return T[LANG][k] || k; }

const DB = {
 JSON.parse(localStorage.getItem('db') || '{}'),
load() { 
try { this.data = JSON.parse(localStorage.getItem('db') || '{}'); } catch { this.seed(); }
},
save() { localStorage.setItem('db', JSON.stringify(this.data)); },
seed() { this.data = {user: {streak:0, xp:0}, decks: [], cards: []}; this.save(); },
updateStreak() { document.getElementById('streak').innerText = this.data.user.streak || 0; }
};

DB.load();

// Full Router
window.Router = {
nav(page) {
Router.current = page;
const vp = document.getElementById('viewport');
Router.updateNav(page);
if (page === 'decks') Router.renderDecks(vp);
else if (page === 'study') Router.renderStudy(vp);
else if (page === 'add') Router.renderAdd(vp);
else if (page === 'profile') Router.renderProfile(vp);
else if (page === 'settings') Router.renderSettings(vp);
},
// implementations for each render...
};

window.Study = {
queue: [], 
start(deckId) {
this.queue = DB.data.cards.filter(c => c.deckId === deckId && c.nextReview <= Date.now()).sort((a,b) => a.nextReview - b.nextReview);
if (this.queue.length === 0) { showToast('Darslar tugadi!'); return; }
Router.nav('study-mode'); // custom
this.renderCard();
},
rate(r) {
if (this.queue.length === 0) { Motivation.show(); return; }
const card = this.queue.shift();
card.nextReview = fsrsNextInterval(card, r);
DB.data.cards = DB.data.cards.map(c => c.id === card.id ? card : c);
DB.save();
DB.data.user.xp += r * 25;
DB.data.user.streak++;
DB.updateStreak();
this.renderCard();
},
// full flip, renderCard...
};

window.Motivation = {
quotes: ['Ilmdan boshqa najot yo\'q - Buxoriy', ...],
show() {
document.getElementById('hikmat').innerText = this.quotes[Math.random()*this.quotes.length];
document.getElementById('motivation').classList.remove('hidden');
},
close() { document.getElementById('motivation').classList.add('hidden'); Router.nav('decks'); }
};

// Sidebar
window.Sidebar = {
open() { document.getElementById('sidebar').classList.add('open'); document.getElementById('overlay').classList.remove('hidden'); },
close() { document.getElementById('sidebar').classList.remove('open'); document.getElementById('overlay').classList.add('hidden'); }
};

// Settings lang toggle
function toggleLang() {
LANG = LANG === 'uz' ? 'en' : 'uz';
localStorage.setItem('lang', LANG);
DB.data.settings.lang = LANG;
DB.save();
location.reload();
}

// Init
DB.updateStreak();
Router.nav('decks');
showToast('Ilm Nuri Premium yuklandi!');
</script>
</body>
</html>
